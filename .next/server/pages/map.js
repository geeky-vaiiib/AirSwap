(()=>{var e={};e.id=538,e.ids=[538,888,660],e.modules={697:(e,t,a)=>{"use strict";a.a(e,async(e,s)=>{try{a.r(t),a.d(t,{config:()=>h,default:()=>p,getServerSideProps:()=>x,getStaticPaths:()=>f,getStaticProps:()=>m,reportWebVitals:()=>g,routeModule:()=>w,unstable_getServerProps:()=>v,unstable_getServerSideProps:()=>S,unstable_getStaticParams:()=>j,unstable_getStaticPaths:()=>b,unstable_getStaticProps:()=>y});var r=a(7093),l=a(5244),n=a(1323),o=a(2899),i=a.n(o),d=a(6814),c=a(3960),u=e([d,c]);[d,c]=u.then?(await u)():u;let p=(0,n.l)(c,"default"),m=(0,n.l)(c,"getStaticProps"),f=(0,n.l)(c,"getStaticPaths"),x=(0,n.l)(c,"getServerSideProps"),h=(0,n.l)(c,"config"),g=(0,n.l)(c,"reportWebVitals"),y=(0,n.l)(c,"unstable_getStaticProps"),b=(0,n.l)(c,"unstable_getStaticPaths"),j=(0,n.l)(c,"unstable_getStaticParams"),v=(0,n.l)(c,"unstable_getServerProps"),S=(0,n.l)(c,"unstable_getServerSideProps"),w=new r.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/map",pathname:"/map",bundlePath:"",filename:""},components:{App:d.default,Document:i()},userland:c});s()}catch(e){s(e)}})},2118:()=>{},2896:()=>{},9767:()=>{},5735:()=>{},3919:()=>{},8131:()=>{},5875:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(1462).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},6848:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(1462).Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},7854:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(1462).Z)("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]])},8864:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{default:function(){return i},noSSR:function(){return o}});let s=a(5577),r=a(997);a(6689);let l=s._(a(4830));function n(e){return{default:(null==e?void 0:e.default)||e}}function o(e,t){delete t.webpack,delete t.modules;let a=t.loading;return()=>(0,r.jsx)(a,{error:null,isLoading:!0,pastDelay:!1,timedOut:!1})}function i(e,t){let a=l.default,s={loading:e=>{let{error:t,isLoading:a,pastDelay:s}=e;return null}};e instanceof Promise?s.loader=()=>e:"function"==typeof e?s.loader=e:"object"==typeof e&&(s={...s,...e});let r=(s={...s,...t}).loader;return(s.loadableGenerated&&(s={...s,...s.loadableGenerated},delete s.loadableGenerated),"boolean"!=typeof s.ssr||s.ssr)?a({...s,loader:()=>null!=r?r().then(n):Promise.resolve(n(()=>null))}):(delete s.webpack,delete s.modules,o(a,s))}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},6814:(e,t,a)=>{"use strict";a.a(e,async(e,s)=>{try{a.r(t),a.d(t,{default:()=>c});var r=a(997),l=a(9752),n=a(3919),o=a(5735),i=a(8131);a(6764);var d=e([l]);let u=new(l=(d.then?(await d)():d)[0]).QueryClient;function c({Component:e,pageProps:t}){return r.jsx(l.QueryClientProvider,{client:u,children:(0,r.jsxs)(i.TooltipProvider,{children:[r.jsx(e,{...t}),r.jsx(n.Toaster,{}),r.jsx(o.Toaster,{})]})})}s()}catch(e){s(e)}})},3960:(e,t,a)=>{"use strict";a.a(e,async(e,s)=>{try{a.r(t),a.d(t,{default:()=>N,getServerSideProps:()=>w});var r=a(997),l=a(6689),n=a(6197),o=a(7854),i=a(5875),d=a(6848),c=a(1664),u=a.n(c),p=a(5152),m=a.n(p),f=a(9767),x=a(2118),h=a.n(x),g=a(2896),y=a.n(g),b=a(6014),j=e([n]);n=(j.then?(await j)():j)[0];let v=m()(()=>a.e(357).then(a.t.bind(a,7357,23)),{loadableGenerated:{modules:["pages/map.tsx -> @/components/map/LeafletMap"]},ssr:!1,loading:()=>r.jsx("div",{className:"h-full w-full flex items-center justify-center bg-sand",children:(0,r.jsxs)("div",{className:"text-center space-y-4",children:[r.jsx(n.motion.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"w-12 h-12 rounded-xl bg-forest/10 flex items-center justify-center mx-auto",children:r.jsx(o.Z,{className:"w-6 h-6 text-forest"})}),r.jsx("p",{className:"text-muted-foreground",children:"Loading map..."})]})})}),S=async()=>{let e=await fetch("/api/ndvi-check");if(!e.ok)throw Error("Failed to fetch NDVI data");let t=await e.json();return{...t,beforeImage:t.beforeImage.startsWith("http")?t.beforeImage:"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=400&h=400&fit=crop",afterImage:t.afterImage.startsWith("http")?t.afterImage:"https://images.unsplash.com/photo-1518173946687-a4c036bc8d7c?w=400&h=400&fit=crop"}},w=async()=>({props:{}}),N=()=>{let[e,t]=(0,l.useState)("select"),[a,s]=(0,l.useState)(!1),[c,p]=(0,l.useState)(null),[m,x]=(0,l.useState)(!1),[g,j]=(0,l.useState)(!1),w=async e=>{x(!0),s(!0),j(!0),t("select");try{let e=await S();p(e),(0,b.Am)({title:"Analysis Complete",description:`NDVI change detected: +${e.ndviDelta}%`})}catch(e){(0,b.Am)({title:"Error",description:"Failed to analyze the selected area",variant:"destructive"})}finally{x(!1)}};return(0,r.jsxs)("div",{className:"h-screen w-screen bg-sand overflow-hidden relative",children:[(0,r.jsxs)(n.motion.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"absolute top-4 left-4 right-4 z-20 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"glass rounded-2xl px-4 py-3 flex items-center gap-4",children:[(0,r.jsxs)(u(),{href:"/",className:"flex items-center gap-2 group",children:[r.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-forest to-emerald flex items-center justify-center",children:r.jsx(o.Z,{className:"w-5 h-5 text-teal"})}),r.jsx("span",{className:"font-display text-lg font-bold text-forest",children:"AirSwap"})]}),r.jsx("div",{className:"w-px h-8 bg-border"}),r.jsx(u(),{href:"/",children:(0,r.jsxs)(f.Button,{variant:"ghost",size:"sm",children:[r.jsx(i.Z,{className:"w-4 h-4 mr-2"}),"Back"]})})]}),(0,r.jsxs)("div",{className:"glass rounded-2xl px-4 py-3 flex items-center gap-2",children:[r.jsx(d.Z,{className:"w-4 h-4 text-muted-foreground"}),r.jsx("span",{className:"text-sm text-muted-foreground",children:"polygon"===e?"Click to draw points, double-click to complete":"Select 'Draw Polygon' to start"})]})]}),(0,r.jsxs)("div",{className:"h-full w-full relative",children:[r.jsx(l.Suspense,{fallback:r.jsx("div",{className:"h-full w-full flex items-center justify-center bg-sand",children:(0,r.jsxs)("div",{className:"text-center space-y-4",children:[r.jsx(n.motion.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"w-12 h-12 rounded-xl bg-forest/10 flex items-center justify-center mx-auto",children:r.jsx(o.Z,{className:"w-6 h-6 text-forest"})}),r.jsx("p",{className:"text-muted-foreground",children:"Loading map..."})]})}),children:r.jsx(v,{onPolygonComplete:w,drawEnabled:"polygon"===e})}),m&&r.jsx(n.motion.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 bg-forest/20 backdrop-blur-sm flex items-center justify-center z-30",children:(0,r.jsxs)("div",{className:"glass rounded-2xl p-8 text-center",children:[r.jsx(n.motion.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"w-16 h-16 rounded-xl bg-teal/20 flex items-center justify-center mx-auto mb-4",children:r.jsx(o.Z,{className:"w-8 h-8 text-teal"})}),r.jsx("p",{className:"font-medium text-forest",children:"Analyzing satellite data..."})]})}),r.jsx(y(),{isOpen:a,onClose:()=>s(!1),ndviData:c,onIssueCredit:()=>{(0,b.Am)({title:"Credit Issued! \uD83C\uDF89",description:"847 Oxygen Credits have been added to your account (Demo)"})}})]}),r.jsx(h(),{activeTool:e,onToolChange:t,onClear:()=>{p(null),s(!1),j(!1),window.location.reload()},canClear:g})]})};s()}catch(e){s(e)}})},6014:(e,t,a)=>{"use strict";a.d(t,{Am:()=>c}),a(6689);let s=0,r=new Map,l=e=>{if(r.has(e))return;let t=setTimeout(()=>{r.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);r.set(e,t)},n=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?l(a):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],i={toasts:[]};function d(e){i=n(i,e),o.forEach(e=>{e(i)})}function c({...e}){let t=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>d({type:"DISMISS_TOAST",toastId:t});return d({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:t}})}}},6764:()=>{},4830:(e,t,a)=>{"use strict";e.exports=a(7093).vendored.contexts.Loadable},5152:(e,t,a)=>{e.exports=a(8864)},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{"use strict";e.exports=require("react")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},5315:e=>{"use strict";e.exports=require("path")},9752:e=>{"use strict";e.exports=import("@tanstack/react-query")},6197:e=>{"use strict";e.exports=import("framer-motion")}};var t=require("../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[899,132,801],()=>a(697));module.exports=s})();